# Windowsユーザのための説明

English version is [here](USER_GUIDE_WINDOWS.md).

## 1. バイナリのダウンロード

1. GitHubの[プロジェクトページ](https://github.com/DEE-BRI/arcclimate-go)にアクセスします。
2. 「Releases」セクションをクリックして、最新のリリースページを開きます。
3. 「Assets」の下にある、Windows向けのバイナリファイル（例: `arcclimate_windows_amd64_v105.zip`）をクリックしてダウンロードします。

## 2. バイナリのインストール

### 2.1 バイナリの解凍

1. ダウンロードしたZIPファイルを、好きな場所（例：デスクトップやダウンロードフォルダ）で右クリックして「すべて展開」を選択します。
2. 指示に従って解凍します。

### 2.2 適切な場所への移動

1. 解凍したフォルダを開きます。
2. 実行ファイルを、例えば`C:\Program Files\ArcClimate`などのフォルダにコピーまたは移動します。この場所は後でPATHを設定する際に使用します。

※ 注意: `Program Files`内に新しいフォルダを作成する場合、管理者権限が必要となることがあります。

### 2.3 `PATH`の設定

`PATH`環境変数に、先ほどの実行ファイルのあるディレクトリを追加することで、コマンドプロンプトやPowerShellから簡単にツールを実行できるようにします。

1. スタートメニューの検索ボックスに「環境変数」と入力し、「システムのプロパティ」の「環境変数」を選択します。
2. 「システムのプロパティ」ウィンドウが開いたら、下部にある「環境変数(N)...」ボタンをクリックします。
3. 「システム環境変数」の中の`Path`を選択し、「編集(E)...」ボタンをクリックします。
4. 「環境変数の編集」ウィンドウが開いたら、「新規(N)」ボタンをクリックし、先ほどの実行ファイルのあるディレクトリのパス（例: `C:\Program Files\ArcClimate`）を入力します。
5. すべてのウィンドウを「OK」で閉じます。

以上で、コマンドプロンプトやPowerShellを開いた際に、あなたのツールがグローバルに利用できるようになります。

※ 注意: PATH設定の流れはWindowsのバージョンに依存します。実際に表示されるメッセージ等から適宜判断してください。

## 3. 基本的な使用方法

### 3.1 コマンドプロンプトの開き方

ArcClimateはコマンドプロンプトで使用します。まずはコマンドプロンプトを開きます。

1. Windowsキーを押し、`cmd`と入力します。
2. 表示される「コマンドプロンプト」をクリックして開きます。

コマンドプロンプトでは、指定されたコマンドを入力し、`Enter`キーを押すことでそのコマンドが実行されます。


### 3.2 主なコマンド引数

ArcClimateのコマンドの形式は次の様に `arcclimate` とlat, lng および オプションで構成されます。
ここでは主なコマンド引数について説明します。

```cmd
arcclimate <lat> <lng> [オプション]
```

- `lag`: 推計対象地点の緯度（10進法）
- `lng`: 推計対象地点の経度（10進法）
- `-o, --output`: 保存ファイルパスを指定します。指定されない場合は標準出力に結果が出力されます。
- `--start_year`:  出力する気象データの開始年を指定します。指定されない場合は `2011` と見なします。
- `--end_year`:  出力する気象データの終了年を指定します。指定されない場合は `2020` と見なします。
- `--mode`: 計算モードの指定しています。標準=`normal`、標準年=`EA`です。デフォルトでは、`normal`です。
- `-f, --file`: 出力形式を指定します。 `CSV`, `EPW` または `HAS` です。デフォルトでは、 `CSV` です。
- `--mode_elevation`: 標高判定方法を指定します。`api`または`mesh`です。デフォルトでは、`api`です。
- `--disable_est`: 指定されると、標準年データの検討に日射量の推計値を使用しません。その場合、2018年以降のデータのみを使用することになります。
- `--msm_file_dir`: ダウンロードしたMSMファイルの格納ディレクトリを指定します。
- `--mode_separate`: 直散分離の方法を指定します。`Nagata`, `Watanabe`, `Ergb`, `Udagawa` または `Perez` が指定可能です。デフォルトでは、 `Perez`を使用します。
- `-h, --help`: ヘルプ情報の表示

なお、出力する気象データの開始年・終了年の指定は標準年データの検討期間を兼ねます。

※ 「`-h, --help`」 は 「`-h`」 または 「`--help`」の何れでも利用できることを示しています。

### 3.3 具体的な使用方法

ArcClimate では、地点の指定を緯度および経度で行います。第 1 引数で指定した緯度の、第 2 引数で
指定した経度の地点における気象データを取得することができます。緯度及び軽度は 10 進数形式です。
また、引数「-o」で保存ファイルパスを指定できます。

例えば、以下のコマンドを入力すると、国立研究開発法人 建築研究所位置のデータを取得することが
でき、結果が「kenken.csv」に保存されます。

```cmd
arcclimate 36.1290111 140.0754174 -o kenken.csv
```

緯度・経度は、国土地理院が公開している計算サイト（[Web 版 TKY2JGD (gsi.go.jp)](https://vldb.gsi.go.jp/sokuchi/surveycalc/tky2jgd/main.html)）や [Google Map](https://www.google.com/maps)
などで検索することが可能です。

また、引数「--mode」に「EA」を指定することで、EA 方式の標準年データを取得することができま
す。引数「--mode」を省略もしくは「normal」とした場合は 10 年分のデータが取得されます

```cmd
arcclimate 36.1290111 140.0754174 -o kenken_EA.csv --mode EA
```

ArcClimateでは空間補間として、標高の補正を実施しています。補正に使用する標高は、指定した緯度・経度
位置における標高データを国土地理院の APIを利用して取得しています。これによって最小 5m 間隔
のピンポイントで空間補間が可能になります。また、メッシュマップなどを作成することも想定して、１
㎞メッシュの平均標高を指定することもできるようにしています。
１㎞メッシュの平均標高を使用する場合には、引数「--mode_elevation」に「mesh」を指定します。
「mesh」が指定された場合、第 1 および第 2 引数で指定した緯度・経度が含まれる１㎞メッシュの平均
標高とメッシュの中心位置の緯度・経度に基づいて空間補間を行います。
例えば、以下のコマンドを入力すると、国立研究開発法人 建築研究所が含まれる 1 ㎞メッシュの平均
標高：26.4m、中心緯度：36.129166、中心経度：140.08125 に基づいて空間補間を実施します。

```cmd
arcclimate 36.1290111 140.0754174 -o kenken_mesh.csv --mode_elevation mesh
```

　データの期間は、デフォルトでは 2011 年から 2020 年までの 10 年間のデータを対象としていますが、
引数「--start_year」に開始年を、引数「--end_year」に終了年を指定することで、任意の期間のみを取
得することも可能です。（ただし、年単位の出力に限り、月・日・時での指定はできません）

例えば、以下のコマンドを入力すると、2015 年から 2018 年までのデータを取得することができます。

```cmd
arcclimate 36.1290111 140.0754174 -o kenken_2015-2018.csv --start_year 2015 --end_year 2018
```

　また、この指定期間は標準年の検討期間も兼ねるため、あわせて引数「--mode」に「EA」を指定する
ことで任意の期間中のデータのみから標準年データを作成することが可能です。

　水平面全天日射量には MSM の日射量データを単に単位換算した値（以下「MSM 日射量」という）と
MSM の気象データに基づいて推計した値（以下、「推計日射量」という）の 2 種類があります。MSM 日
射量は 2017 年 12 月 5 日以降からの公開であり、10 年分のデータが揃っていません。より精度が高いデ
ータである MSM 日射量のみで標準年の作成を行いたい場合には、引数「--disable_est」を指定する
ことで、推計日射量を使用せずに標準年データを取得できます。ただし、上述のように、MSM 日射量に
は 2018 年以前のデータが存在しないことから、「--disable_est」を指定する場合には「--start_year」
を 2018 以降に設定する必要があります。

```cmd
arcclimate 36.1290111 140.0754174 -o kenken_EA_non-est.csv --mode EA --use_est False --
start_year 2018
```
